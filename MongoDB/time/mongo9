#!/bin/bash
mongo localhost:27017/time --eval 'db.time.aggregate([{"$match":{"$and":[{"t_hour":8},{"t_minute":{"$gte":30}}]}},{"$unwind": "$store_sales"},{"$match":{"$and":[{"$or":[{"$and":[{"store_sales.customer.hd_dep_count":1},{"store_sales.customer.hd_vehicle_count":{"$lte":3}}]},{"$and":[{"store_sales.customer.hd_dep_count":2},{"store_sales.customer.hd_vehicle_count":{"$lte":4}}]},{"$and":[{"store_sales.customer.hd_dep_count":3},{"store_sales.customer.hd_vehicle_count":{"$lte":5}}]}]},{"store_sales.s_store_name":"ese"}]}},{"$group":{"_id":null, "h8_30_to_9":{"$sum":1}}}]).toArray()'