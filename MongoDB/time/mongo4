#!/bin/bash
mongo localhost:27017/time --eval 'db.time.aggregate([{"$match":{"$and":[{"store_sales.customer.cd_gender":"F"},{"store_sales.customer.cd_marital_status":"S"},{"store_sales.customer.cd_education_status":"Secondary"},{"store_sales.date.d_year":2001},{"store_sales.s_state":"TN"}]}},{"$unwind": "$store_sales"},{"$match":{"$and":[{"store_sales.customer.cd_gender":"F"},{"store_sales.customer.cd_marital_status":"S"},{"store_sales.customer.cd_education_status":"Secondary"},{"store_sales.date.d_year":2001},{"store_sales.s_state":"TN"}]}},{"$project":{"store_sales.item.i_item_id":1, "store_sales.s_state":1, "store_sales.ss_sales_price":1}},{$group:{"_id":{"i_item_id": "$store_sales.item.i_item_id","s_state":"$store_sales.s_state"}, "agg":{"$sum":"$store_sales.ss_sales_price"}}},{"$limit":100}]).toArray()' >>~/Documentos/benchmarktpc/mongoDB/time/resultados/query4.txt