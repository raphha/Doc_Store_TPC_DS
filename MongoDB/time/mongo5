#!/bin/bash
mongo localhost:27017/time --eval 'db.time.aggregate([{$match:{$and:[{"store_sales.item.i_category":{"$in":["Music","Home","Sports"]}},{"store_sales.date.d_month_seq":{"$gte":1200,"$lte":1211}}]}},{$unwind: "$store_sales"},{$match:{$and:[{"store_sales.item.i_category":{"$in":["Music","Home","Sports"]}},{"store_sales.date.d_month_seq":{"$gte":1200,"$lte":1211}}]}},{$project:{"store_sales.item.i_item_id":1, "store_sales.item.i_item_desc":1, "store_sales.item.i_category":1,"store_sales.item.i_class":1,"store_sales.item.i_current_price":1, "store_sales.ss_ext_sales_price":1}},{$group:{"_id":{"i_item_id":"$store_sales.item.i_item_id", "i_item_desc":"$store_sales.item.i_item_desc", "i_category":"$store_sales.item.i_category","i_class":"$store_sales.item.i_class","i_current_price":"$store_sales.item.i_current_price"}, itemrevenue:{$sum:"$store_sales.ss_ext_sales_price"}}}]).toArray()' >>~/Documentos/benchmarktpc/mongoDB/time/resultados/query5nova.txt