#!/bin/bash
mongo localhost:27017/date --eval 'db.date.aggregate([{$match:{$and:[{"store_sales.item.i_manufact_id":600},{"d_moy":12}]}},{$unwind: "$store_sales"},{$match:{$and:[{"store_sales.item.i_manufact_id":600},{"d_moy":12}]}},{$project:{"d_year":1, "store_sales.item.i_brand_id":1, "store_sales.item.i_brand":1, "store_sales.ss_sales_price":1}},{$group:{"_id":{"d_year": "$d_year", "i_brand_id": "$store_sales.item.i_brand_id","i_brand":"$store_sales.item.i_brand"}, revenue:{$sum:"$store_sales.ss_sales_price"}}}]).toArray()' >>~/Documentos/benchmarktpc/mongoDB/date/resultados/query1.txt