#!/bin/bash
mongo localhost:27017/date --eval 'db.date.aggregate([{"$match":{"$and":[{"d_year":{"$in":[1999,2000,2001]}},{"d_dom":{"$in":[20,21]}},{"$or":[{"store_sales.customer.hd_dep_count":4},{"store_sales.customer.hd_vehicle_count":2}]},{"store_sales.s_city":"Midway"}]}},{"$unwind": "$store_sales"},{"$match":{"$and":[{"d_year":{"$in":[1999,2000,2001]}},{"d_dom":{"$in":[20,21]}},{"$or":[{"store_sales.customer.hd_dep_count":4},{"store_sales.customer.hd_vehicle_count":2}]},{"store_sales.s_city":"Midway"}]}},{"$project":{"store_sales.customer.c_last_name":1, "store_sales.customer.c_first_name":1, "store_sales.customer.ca_city":1,"store_sales.ss_ticket_number":1,"store_sales.ss_ext_sales_price":1}},{$group:{"_id":{"store_sales.customer.c_last_name": "$store_sales.customer.c_last_name","store_sales.customer.c_first_name":"$store_sales.customer.c_first_name", "store_sales.customer.ca_city":"$store_sales.customer.ca_city", "ss_ticket_number": "$store_sales.ss_ticket_number"}, "agg":{"$sum":"$store_sales.ss_ext_sales_price"}}}]).toArray()' >>~/Documentos/benchmarktpc/mongoDB/date/resultados/query6.txt