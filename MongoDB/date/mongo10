#!/bin/bash
mongo localhost:27017/date --eval 'db.date.aggregate([{"$match":{"$and":[{"d_year":2000},{"$or":[{"$and":[{"store_sales.item.i_category":{"$in":["Music","Home","Sports"]}},{"store_sales.item.i_class":{"$in":["country","rugs","fishing"]}}]},{"$and":[{"store_sales.item.i_category":{"$in":["Women","Children","Men"]}},{"store_sales.item.i_class":{"$in":["swimwear","shirts","pants"]}}]}]}]}},{"$unwind": "$store_sales"},{"$match":{"$and":[{"d_year":2000},{"$or":[{"$and":[{"store_sales.item.i_category":{"$in":["Music","Home","Sports"]}},{"store_sales.item.i_class":{"$in":["country","rugs","fishing"]}}]},{"$and":[{"store_sales.item.i_category":{"$in":["Women","Children","Men"]}},{"store_sales.item.i_class":{"$in":["swimwear","shirts","pants"]}}]}]}]}},{"$project":{"store_sales.item.i_category":1,"store_sales.item.i_class":1,"store_sales.item.i_brand":1,"store_sales.s_store_name":1, "store_sales.s_company_name":1,"d_moy":1, "store_sales.ss_sales_price":1}},{"$group":{"_id":{"i_category":"$store_sales.item.i_category","i_class":"$store_sales.item.i_class","i_brand":"$store_sales.item.i_brand","s_store_name":"$store_sales.s_store_name", "s_company_name":"$store_sales.s_company_name","d_moy":"$d_moy"}, "sum_sales":{"$sum":"$store_sales.ss_sales_price"}}}]).toArray()' >>~/Documentos/benchmarktpc/mongoDB/date/resultados/query10.txt