#!/bin/bash
mongo localhost:27017/customer --eval 'db.customer.aggregate([{"$match":{"$and":[{"$or":[{"hd_dep_count":4},{"hd_vehicle_count":2}]},{"store_sales.date.d_year":{"$in":[1999,2000,2001]}},{"store_sales.date.d_dom":{"$in":[20,21]}},{"store_sales.s_city":"Midway"}]}},{"$unwind": "$store_sales"},{"$match":{"$and":[{"$or":[{"hd_dep_count":4},{"hd_vehicle_count":2}]},{"store_sales.date.d_year":{"$in":[1999,2000,2001]}},{"store_sales.date.d_dom":{"$in":[20,21]}},{"store_sales.s_city":"Midway"}]}},{"$project":{"c_last_name":1, "c_first_name":1, "ca_city":1,"store_sales.ss_ticket_number":1,"store_sales.ss_ext_sales_price":1}},{$group:{"_id":{"c_last_name": "$c_last_name","c_first_name":"$c_first_name", "ca_city":"$ca_city", "ss_ticket_number": "$store_sales.ss_ticket_number"}, "agg":{"$sum":"$store_sales.ss_ext_sales_price"}}}]).toArray()' >>~/Documentos/benchmarktpc/mongoDB/customer/resultados/query6.txt